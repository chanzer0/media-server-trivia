{% extends 'base.html' %}

{% block content %}
<div class="game-container">
  <div class="game-header">
    <h2 class="game-title-page">Frame Color Challenge</h2>
    <p class="hero-subtitle">Can you identify the movie from its color patterns?</p>
  </div>

  <!-- Loading State -->
  <div id="loadingState" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Analyzing video frames...</p>
    <small>This may take a moment as we process the movie file</small>
  </div>

  <!-- Color Bar Display -->
  <div id="colorBarContainer" class="color-bar-container" style="display: none;">
    <div class="color-bar-wrapper">
      <canvas id="colorBar" class="color-bar-canvas"></canvas>
      <div class="color-bar-info">
        <span id="frameCount" class="frame-info"></span>
        <span id="sampleRate" class="frame-info"></span>
      </div>
    </div>
    
  </div>

  <!-- Input Section -->
  <div class="input-group" style="display: none;" id="inputSection">
    <div class="input-container">
      <input 
        id="guessInput" 
        class="form-control" 
        placeholder="Enter movie title..."
        autocomplete="off"
      >
      <div id="customDropdown" class="custom-dropdown"></div>
    </div>
    <button class="btn btn-primary" id="guessBtn">
      Submit Guess
      <svg class="btn-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
      </svg>
    </button>
  </div>

  <!-- Result Display -->
  <div id="frameResult"></div>

  <!-- Game Info -->
  <div class="game-info">
    <h4>How to Play:</h4>
    <ul>
      <li>Each vertical line represents the average color of a movie frame</li>
      <li>Colors flow from left to right throughout the movie</li>
      <li>Look for patterns, color shifts, and distinctive visual signatures</li>
      <li>Click on any color bar to see which sample it represents</li>
    </ul>
  </div>

  <!-- Game Controls -->
  <div class="game-controls mt-4 text-center">
    <button class="btn btn-secondary" onclick="location.reload()">
      <svg class="btn-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
      </svg>
      New Game
    </button>
  </div>
</div>

<script src="{{ url_for('static', filename='frame.js') }}"></script>

<style>
.loading-container {
  text-align: center;
  padding: 4rem 2rem;
}

.loading-spinner {
  width: 50px;
  height: 50px;
  border: 4px solid var(--border-color);
  border-top: 4px solid var(--primary-color);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 1rem;
}

.color-bar-container {
  margin: 2rem 0;
}

.color-bar-wrapper {
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: var(--radius-lg);
  padding: 1rem;
  margin-bottom: 1rem;
  box-shadow: var(--shadow-md);
}

.color-bar-canvas {
  width: 100%;
  height: 100px;
  border-radius: var(--radius-md);
  cursor: crosshair;
  background: var(--bg-tertiary);
}

.color-bar-info {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.875rem;
  color: var(--text-secondary);
}


.game-info {
  background: var(--bg-card);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-lg);
  padding: 1.5rem;
  margin-top: 2rem;
}

.game-info h4 {
  color: var(--primary-color);
  margin-bottom: 1rem;
}

.game-info ul {
  margin: 0;
  padding-left: 1.5rem;
}

.game-info li {
  margin-bottom: 0.5rem;
  color: var(--text-secondary);
}

@media (max-width: 768px) {
  .color-bar-canvas {
    height: 80px;
  }
  
  
  .color-bar-info {
    flex-direction: column;
    gap: 0.25rem;
    text-align: center;
  }
}
</style>
{% endblock %}